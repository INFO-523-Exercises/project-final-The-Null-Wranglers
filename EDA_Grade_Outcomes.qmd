---
title: "Exploratory Data Analysis of Grade Outcomes Data"
author: "The Null wranglers"
editor: visual
---

```{r message=FALSE, output=FALSE}
#| code-fold: true
#| code-summary: "Load Libraries"

suppressWarnings(library(tidyverse))
library(knitr)
library(lubridate)
library(ggplot2)
```

```{r}
#| code-fold: true
#| code-summary: "Read in Data"
# read in data
dew_data <- read.csv("data/clean_dew_data.csv")
kable(head(dew_data))

```

Add brief description of data

## Total number of courses per semester - K

```{r}
#| code-fold: true
#| code-summary: "summary of total courses"

# add the column names
table1<- dew_data %>% group_by(College) %>% count(TERM_LD)
table1 <- table1 %>% pivot_wider(names_from = TERM_LD, values_from = n)
kable(table1, caption = "Total Course Offering for Each College per Semester")
```

After examining this data, we are limiting the colleges to x,y, z because a, b,c .

```{r}
#| code-fold: true
#| code-summary: "remove low course offering colleges"
dew_data <- dew_data %>% filter(College != "College of Medicine - Tucson",
                                College != "College of Nursing",
                                College != "College of Public Health",
                                College != "Colleges of Letters Arts & Sci",
                                College != "Graduate College",
                                College != "James E Rogers College of Law",
                                College != "R Ken Coit College of Pharmacy",
                                College != "W.A. Franke Honors College")

```

```{r }
#| code-fold: true
#| code-summary: "summary of total enrollment"
# total enrollment table
enrollment <- aggregate(Total.Student.Count~College + TERM_LD, data=dew_data, sum)
enrollment <- enrollment %>% pivot_wider(names_from = TERM_LD, values_from = Total.Student.Count)
kable(enrollment, caption =  "Total Student Enrollment for Each College per Semester")
```

```{r}
#| code-fold: true
#| code-summary: "summary of total enrollment"
dew_total <- aggregate(DEW_COUNT~College + TERM_LD, data=dew_data, sum)
dew_total <- dew_total %>% pivot_wider(names_from = TERM_LD, values_from = DEW_COUNT)
kable(dew_total, caption =  "Total D, F, W Grade Counts for Each College per Semester")
```

Go down to just top 5 colleges

```{r}
#| code-fold: true
#| code-summary: "summary of total enrollment"
dew_data <- dew_data %>% filter(College != "College of Applied Sci & Tech",
                                College != "College of Education",
                                College != "College of Engineering",
                                College != "College of Fine Arts")
```

## Overall Averages - R

```{r}
#| code-fold: true
#| code-summary: "average number of students per course"
student_per_course <- aggregate(Total.Student.Count ~College + TERM_LD, data=dew_data, mean)
# round to nearest whole digit
student_per_course$Total.Student.Count <- round(student_per_course$Total.Student.Count)
# pivot wider
student_per_course <- student_per_course %>% pivot_wider(names_from = TERM_LD, values_from = Total.Student.Count)
# display table
kable(student_per_course, caption =  "Average Number of Students per Course by College Each Semester")
```

```{r}
#| code-fold: true
#| code-summary: "average number of students per course"
dew_per_course <- aggregate(Percent.DEW ~College + TERM_LD, data=dew_data, mean)
# round to 2 digits
dew_per_course$Percent.DEW <- round(dew_per_course$Percent.DEW, 2)
# pivot wider
dew_per_course <- dew_per_course %>% pivot_wider(names_from = TERM_LD, values_from = Percent.DEW)
# display table
kable(dew_per_course, caption =  "Average Number of D, F, and W Grade(percentage) per Course by College Each Semester")
```

Despite enrollment staying steady, we see a noticeable decrease in DEW outcomes for the spring of 2020. Followed by an increase for the fall of 2020.

```{r}
# should we add a line chart here?
  
```

## Averages by College -R

Calc the mean averages overall - high - enrollemnt, pass, d, e, w, dew

Visualiaze in bar

```{r}
# Assuming you have the ggplot2 library installed
# If not, install it using install.packages("ggplot2")
library(ggplot2)

# Define the order of variables
variable_order <- c( "Pass Grade Count", "D Grade Count", "Fail Grade Count", "Withdraw Grade Count", "DEW Count")

# Creating a data frame with the means
means_data <- data.frame(
  Variable = factor(variable_order, levels = variable_order),
  Mean_Value = c(
    #mean(clean_dew_data$Total.Student.Count), Write a note on this
    mean(dew_data$PASS_GRADE_COUNT),
    mean(dew_data$D_GRADE_COUNT),
    mean(dew_data$FAIL_GRADE_COUNT),
    mean(dew_data$WITHDRAW_GRADE_COUNT),
    mean(dew_data$DEW_COUNT)
  )
)

# Creating a bar plot
ggplot(means_data, aes(x = Variable, y = Mean_Value, fill = Variable)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = round(Mean_Value, 2)), vjust = -0.5, size = 3) +  # Add text labels
  labs(title = "Mean of Percentages of Pass grade along with DEW Grades",
       x = "Variables",
       y = "Mean Value") +
  theme_minimal()

```

```{r}
# Assuming you have the dplyr, knitr, and stringr libraries installed
# If not, install them using install.packages(c("dplyr", "knitr", "stringr"))
library(dplyr)
library(knitr)
library(stringr)

# Group by College and calculate the mean for each grade-related column
college_means_data <- dew_data %>%
  group_by(College) %>%
  summarise(PASS_GRADE_COUNT = mean(PASS_GRADE_COUNT),
            D_GRADE_COUNT = mean(D_GRADE_COUNT),
            FAIL_GRADE_COUNT = mean(FAIL_GRADE_COUNT),
            WITHDRAW_GRADE_COUNT = mean(WITHDRAW_GRADE_COUNT),
            DEW_COUNT = mean(DEW_COUNT))

# Remove underscores from column names
names(college_means_data) <- str_replace_all(names(college_means_data), "_", " ")

# Round off mean values to two decimal points
college_means_data[, -1] <- round(college_means_data[, -1], 2)

# Create a kable table for means of each grade-related column for each college
kable(college_means_data, 
               caption = "Means for Total Pass, D, E, W, and Total DEW Counts Across Colleges")

```

```{r}

```

## 
