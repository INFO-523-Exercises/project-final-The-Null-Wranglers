---
format: html
editor: visual
---

```{r}
#| label: load-pkgs
#| message: false

suppressWarnings(library(tidyverse))
library(knitr)
library(lubridate)
library(ggplot2)
```

## Dataset Setup

```{r}
#| code-fold: true
#| code-summary: "Load data"
# read in data
study_data <- read.csv("data/study_data.csv")
summary(study_data)
```

```{r}
#| code-fold: true
#| code-summary: "Load Libraries"
# How time affects classes (columns AH to AM) for different colleges? - Anjani

library(dplyr)

# Create a table for each time slot
time_slots <- c("Early_Morning", "Mid_Morning", "Early_Afternoon", "Mid_Afternoon", "Evening", "Asynchronous")

tables_list <- lapply(time_slots, function(slot) {
  table_data <- study_data %>%
    group_by(College) %>%
    summarise(Mean_Classes_Attended = round(mean(get(slot), na.rm = TRUE), 2))
  
  names(table_data)[2] <- paste("Mean_", slot)
  table_data
})

# Merge tables into a single table by College name
merged_table <- Reduce(function(x, y) merge(x, y, by = "College", all = TRUE), tables_list)

# Display the merged table
kable(merged_table)

```

```{r}
#| code-fold: true
#| code-summary: "Load Libraries"
# Total number of classes per week (AN to AT) in different colleges - Anjani

library(dplyr)

# Create a table for each day of the week
weekdays <- c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday")

tables_list <- lapply(weekdays, function(day) {
  table_data <- study_data %>%
    group_by(College) %>%
    summarise(Mean_Classes_Attended = round(mean(get(day), na.rm = TRUE), 2))
  
  names(table_data)[2] <- paste("Mean_Classes_", day)
  table_data
})

# Merge tables into a single table by College name
merged_table <- Reduce(function(x, y) merge(x, y, by = "College", all = TRUE), tables_list)

# Display the merged table
kable(merged_table)

```

```{r}
#| code-fold: true
#| code-summary: "Load Libraries"
# Mean Number of students enrolled in in-person vs online vs … (BC to BH) for different colleges - Utkarsha

library(dplyr)

# Create a table for each course type
course_types <- c("In_Person", "Full_Online", "IntractTV", "Hybrid", "Live_Online")

tables_list <- lapply(course_types, function(course) {
  table_data <- study_data %>%
    group_by(College) %>%
    summarise(Mean_Enrollment = round(mean(get(course), na.rm = TRUE), 2))
  
  names(table_data)[2] <- paste("Mean_Enrollment_", course)
  table_data
})

# Merge tables into a single table by College name
merged_table <- Reduce(function(x, y) merge(x, y, by = "College", all = TRUE), tables_list)

# Display the merged table
kable(merged_table)

```

```{r}
#| code-fold: true
#| code-summary: "Load Libraries"
# Mean Number of students enrolled in in-person vs online vs … (BC to BH) for different colleges - Utkarsha

library(dplyr)

# Create a table for each course type
course_types <- c("Reg_Session", "First_Half_Session", "Second_Half_Session", "First_Third_Session", "Second_Third_Session", "Third_Third_Session", "Ten_Week", "Thirteen_Week", "Other")

tables_list <- lapply(course_types, function(course) {
  table_data <- study_data %>%
    group_by(College) %>%
    summarise(Mean_Enrollment = round(mean(get(course), na.rm = TRUE), 2))
  
  names(table_data)[2] <- paste("Mean_Enrollment_", course)
  table_data
})

# Merge tables into a single table by College name
merged_table <- Reduce(function(x, y) merge(x, y, by = "College", all = TRUE), tables_list)

# Display the merged table
kable(merged_table)
```
